{"#",e603c0f2-92fb-4d47-8f38-a44a381cf235,
{1,
{5,
{0,"Запрос",
{"Pattern",
{"S"}
},"",0},
{1,"ТекстЗапроса",
{"Pattern",
{"S"}
},"",0},
{2,"ПараметрыЗапроса",
{"Pattern",
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663}
},"",0},
{3,"СпособВыгрузки",
{"Pattern",
{"N"}
},"",0},
{4,"ШиринаКолонок",
{"Pattern",
{"N"}
},"",0}
},
{2,5,0,0,1,1,2,2,3,3,4,4,
{1,1,
{2,0,5,
{"S","Запросы"},
{"S","ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг) КАК ДокументРеализации,
	СУММА(РасчетыСКлиентами.Сумма) КАК Сумма,
	РасчетыСКлиентами.ЗаказКлиента
ПОМЕСТИТЬ ВТ_ДокументыРеализацииОбщая
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.ДокументыВыгружаемыеВОтчетОРозничныхПродажах КАК ДокументыВыгружаемыеВОтчетОРозничныхПродажах
		ПО РасчетыСКлиентами.Регистратор = ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки
ГДЕ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)
	И ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки ЕСТЬ NULL 

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации
ПОМЕСТИТЬ ВТ_РеализацииБанковскийКредит
ИЗ
	ВТ_ДокументыРеализацииОбщая КАК ВТ_ДокументыРеализации
ГДЕ
	ВТ_ДокументыРеализации.ДокументРеализации.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.ФормыОплаты.БанковскийКредит)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.Сумма,
	ВТ_ДокументыРеализации.ЗаказКлиента
ПОМЕСТИТЬ ВТ_ДокументыРеализации
ИЗ
	ВТ_ДокументыРеализацииОбщая КАК ВТ_ДокументыРеализации
		ПОЛНОЕ СОЕДИНЕНИЕ ВТ_РеализацииБанковскийКредит КАК ВТ_РеализацииБанковскийКредит
		ПО ВТ_ДокументыРеализации.ДокументРеализации = ВТ_РеализацииБанковскийКредит.ДокументРеализации
ГДЕ
	ВТ_РеализацииБанковскийКредит.ДокументРеализации ЕСТЬ NULL 
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента
ПОМЕСТИТЬ ВТ_РеализацииБезЗаказа
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
ГДЕ
	НЕ ВТ_ДокументыРеализации.ЗаказКлиента.РеализацияПоЗаказам
	И ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Документ.РеализацияТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВЫРАЗИТЬ(ВТ_РеализацииБезЗаказа.ЗаказКлиента КАК Документ.РеализацияТоваровУслуг) КАК ДокументРеализации,
	РасчетыСКлиентами.Регистратор КАК ДокументОплаты
ПОМЕСТИТЬ ВТ_РеализацииБезЗаказаСПредоплатой
ИЗ
	ВТ_РеализацииБезЗаказа КАК ВТ_РеализацииБезЗаказа
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_РеализацииБезЗаказа.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
	И РАЗНОСТЬДАТ(ВТ_РеализацииБезЗаказа.ЗаказКлиента.Дата, РасчетыСКлиентами.Регистратор.Дата, СЕКУНДА) <= 0

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВЫРАЗИТЬ(ВТ_РеализацииБезЗаказа.ЗаказКлиента КАК Документ.РеализацияТоваровУслуг),
	РасчетыСКлиентами.Регистратор
ИЗ
	ВТ_РеализацииБезЗаказа КАК ВТ_РеализацииБезЗаказа
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_РеализацииБезЗаказа.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ОперацияПоПлатежнойКарте
	И РАЗНОСТЬДАТ(ВТ_РеализацииБезЗаказа.ЗаказКлиента.Дата, РасчетыСКлиентами.Регистратор.Дата, СЕКУНДА) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) КАК ДокументОплаты
ПОМЕСТИТЬ ВТ_ЗаказыКлиентаСПредоплатой
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Документ.ЗаказКлиента
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) ЕСТЬ НЕ NULL 
	И РАЗНОСТЬДАТ(ВТ_ДокументыРеализации.ДокументРеализации.Дата, РасчетыСКлиентами.Регистратор.Дата, СЕКУНДА) <= 0

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте)
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Документ.ЗаказКлиента
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте) ЕСТЬ НЕ NULL 
	И РАЗНОСТЬДАТ(ВТ_ДокументыРеализации.ДокументРеализации.Дата, РасчетыСКлиентами.Регистратор.Дата, СЕКУНДА) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор
ПОМЕСТИТЬ ВТ_Соглашения
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Справочник.СоглашенияСКлиентами
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
	И РасчетыСКлиентами.Регистратор.ДокументОснование = ВТ_ДокументыРеализации.ДокументРеализации

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Справочник.СоглашенияСКлиентами
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
	И РасчетыСКлиентами.Регистратор.ДокументОснование = ВТ_ДокументыРеализации.ДокументРеализации.ЗаказКлиента

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Справочник.СоглашенияСКлиентами
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ОперацияПоПлатежнойКарте
	И РасчетыСКлиентами.Регистратор.ДокументОснование = ВТ_ДокументыРеализации.ДокументРеализации

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации,
	ВТ_ДокументыРеализации.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ДокументыРеализации.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	ВТ_ДокументыРеализации.ЗаказКлиента ССЫЛКА Справочник.СоглашенияСКлиентами
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.ОперацияПоПлатежнойКарте
	И РасчетыСКлиентами.Регистратор.ДокументОснование = ВТ_ДокументыРеализации.ДокументРеализации.ЗаказКлиента
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Соглашения.ДокументРеализации,
	ВТ_Соглашения.ЗаказКлиента,
	ВТ_Соглашения.Регистратор
ПОМЕСТИТЬ ВТ_СоглашенияСПредоплатой
ИЗ
	ВТ_Соглашения КАК ВТ_Соглашения
ГДЕ
	РАЗНОСТЬДАТ(ВТ_Соглашения.ДокументРеализации.Дата, ВТ_Соглашения.Регистратор.Дата, СЕКУНДА) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_РеализацииБезЗаказаСПредоплатой.ДокументРеализации КАК ДокументОтгрузки,
	ВТ_РеализацииБезЗаказаСПредоплатой.ДокументРеализации.ОрганизацияБУ КАК ОрганизацияБУ
ИЗ
	ВТ_РеализацииБезЗаказаСПредоплатой КАК ВТ_РеализацииБезЗаказаСПредоплатой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_ЗаказыКлиентаСПредоплатой.ДокументРеализации,
	ВТ_ЗаказыКлиентаСПредоплатой.ДокументРеализации.ОрганизацияБУ
ИЗ
	ВТ_ЗаказыКлиентаСПредоплатой КАК ВТ_ЗаказыКлиентаСПредоплатой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_СоглашенияСПредоплатой.ДокументРеализации,
	ВТ_СоглашенияСПредоплатой.ДокументРеализации.ОрганизацияБУ
ИЗ
	ВТ_СоглашенияСПредоплатой КАК ВТ_СоглашенияСПредоплатой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_РеализацииБанковскийКредит.ДокументРеализации,
	ВТ_РеализацииБанковскийКредит.ДокументРеализации.ОрганизацияБУ
ИЗ
	ВТ_РеализацииБанковскийКредит КАК ВТ_РеализацииБанковскийКредит"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{9,
{3,
{0,"ИмяПараметра",
{"Pattern",
{"S"}
},"",0},
{1,"ЗначениеПараметра",
{"Pattern"},"",0},
{2,"ЭтоВыражение",
{"Pattern",
{"B"}
},"",0}
},
{2,3,0,0,1,1,2,2,
{1,1,
{2,0,3,
{"S","Дата"},
{"D",20171030000000},
{"B",0},0}
},2,0},
{0,0}
}
},
{"N",1},
{"N",54},1,
{1,4,
{2,1,5,
{"S","1"},
{"S","ВЫБРАТЬ
	""Д1"" КАК Поле1
ПОМЕСТИТЬ ВТ_1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	""Д2""
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	""Д3"" КАК Поле1
ПОМЕСТИТЬ ВТ_2

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	""Д4""
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	""Д1"" КАК Поле1
ПОМЕСТИТЬ ВТ_3

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	""Д3""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	""Д5""
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_3.Поле1 КАК Поле11
ИЗ
	ВТ_1 КАК ВТ_1
		ПОЛНОЕ СОЕДИНЕНИЕ ВТ_3 КАК ВТ_3
			ПОЛНОЕ СОЕДИНЕНИЕ ВТ_2 КАК ВТ_2
			ПО ВТ_2.Поле1 = ВТ_3.Поле1
		ПО ВТ_1.Поле1 = ВТ_3.Поле1
ГДЕ
	ВТ_1.Поле1 ЕСТЬ NULL 
	И ВТ_2.Поле1 ЕСТЬ NULL "},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{9,
{3,
{0,"ИмяПараметра",
{"Pattern",
{"S"}
},"",0},
{1,"ЗначениеПараметра",
{"Pattern"},"",0},
{2,"ЭтоВыражение",
{"Pattern",
{"B"}
},"",0}
},
{2,3,0,0,1,1,2,2,
{1,0},2,-1},
{0,0}
}
},
{"N",1},
{"N",15},0},
{2,2,5,
{"S","1 этап"},
{"S","ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) КАК ДокументОплаты,
	СУММА(РасчетыСКлиентами.Сумма) КАК Сумма,
	РасчетыСКлиентами.ЗаказКлиента
ПОМЕСТИТЬ ВТ_ДокументыОплаты
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
ГДЕ
	РасчетыСКлиентами.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеОплатыОтКлиентаВКассуККМ)
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте),
	СУММА(РасчетыСКлиентами.Сумма),
	РасчетыСКлиентами.ЗаказКлиента
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
ГДЕ
	РасчетыСКлиентами.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеОплатыОтКлиента)
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_ДокументыОплаты.ЗаказКлиента,
	ВТ_ДокументыОплаты.ДокументОплаты
ПОМЕСТИТЬ ВТ_РеализацииБезЗаказа
ИЗ
	ВТ_ДокументыОплаты КАК ВТ_ДокументыОплаты
ГДЕ
	ВТ_ДокументыОплаты.ЗаказКлиента ССЫЛКА Документ.РеализацияТоваровУслуг
	И НЕ ВТ_ДокументыОплаты.ЗаказКлиента.РеализацияПоЗаказам
	И РАЗНОСТЬДАТ(ВТ_ДокументыОплаты.ДокументОплаты.Дата, ВТ_ДокументыОплаты.ЗаказКлиента.Дата, ДЕНЬ) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВТ_РеализацииБезЗаказа.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор КАК ДокументОтгрузки,
	ВТ_РеализацииБезЗаказа.ДокументОплаты
ПОМЕСТИТЬ ВТ_РеализацииБезЗаказаБезОстатка
ИЗ
	ВТ_РеализацииБезЗаказа КАК ВТ_РеализацииБезЗаказа
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(
				,
				ЗаказКлиента В
					(ВЫБРАТЬ
						ВТ_РеализацииБезЗаказа.ЗаказКлиента
					ИЗ
						ВТ_РеализацииБезЗаказа КАК ВТ_РеализацииБезЗаказа)) КАК РасчетыСКлиентамиОстатки
		ПО ВТ_РеализацииБезЗаказа.ЗаказКлиента = РасчетыСКлиентамиОстатки.ЗаказКлиента
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_РеализацииБезЗаказа.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	РасчетыСКлиентамиОстатки.ЗаказКлиента ЕСТЬ NULL 
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыОплаты.ЗаказКлиента,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДЕНЬ(ВТ_ДокументыОплаты.ДокументОплаты.Дата)) КАК ДокументОплатыДата,
	СУММА(ВТ_ДокументыОплаты.ДокументОплаты.СуммаДокумента) КАК СуммаДокументаОплаты,
	ВТ_ДокументыОплаты.ДокументОплаты.ДокументОснование.СуммаДокумента КАК СуммаДокументаОтгрузки
ПОМЕСТИТЬ ВТ_ЗаказыКлиента
ИЗ
	ВТ_ДокументыОплаты КАК ВТ_ДокументыОплаты
ГДЕ
	ВТ_ДокументыОплаты.ЗаказКлиента ССЫЛКА Документ.ЗаказКлиента

СГРУППИРОВАТЬ ПО
	ВТ_ДокументыОплаты.ЗаказКлиента,
	ВТ_ДокументыОплаты.ДокументОплаты.ДокументОснование.СуммаДокумента
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ЗаказыКлиента.ЗаказКлиента,
	ВТ_ДокументыОплаты.ДокументОплаты.ДокументОснование КАК ДокументОплатыОснование,
	ВТ_ДокументыОплаты.ДокументОплаты
ПОМЕСТИТЬ ВТ_ЗаказыСОплатойВОдниДень
ИЗ
	ВТ_ЗаказыКлиента КАК ВТ_ЗаказыКлиента
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДокументыОплаты КАК ВТ_ДокументыОплаты
		ПО ВТ_ЗаказыКлиента.ЗаказКлиента = ВТ_ДокументыОплаты.ЗаказКлиента
ГДЕ
	ВТ_ЗаказыКлиента.ДокументОплатыДата = 1
	И ВТ_ЗаказыКлиента.СуммаДокументаОплаты = ВТ_ЗаказыКлиента.СуммаДокументаОтгрузки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ЗаказыСОплатойВОдниДень.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор КАК ДокументОтгрузки,
	ВТ_ЗаказыСОплатойВОдниДень.ДокументОплаты
ПОМЕСТИТЬ ВТ_ЗаказыКлиентаБезОстатка
ИЗ
	ВТ_ЗаказыСОплатойВОдниДень КАК ВТ_ЗаказыСОплатойВОдниДень
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами.Остатки(
				,
				ЗаказКлиента В
					(ВЫБРАТЬ
						ВТ_ЗаказыКлиента.ЗаказКлиента
					ИЗ
						ВТ_ЗаказыКлиента КАК ВТ_ЗаказыКлиента)) КАК РасчетыСКлиентамиОстатки
		ПО ВТ_ЗаказыСОплатойВОдниДень.ЗаказКлиента = РасчетыСКлиентамиОстатки.ЗаказКлиента
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ЗаказыСОплатойВОдниДень.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
ГДЕ
	РасчетыСКлиентамиОстатки.ЗаказКлиента ЕСТЬ NULL 
	И РасчетыСКлиентами.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	И РАЗНОСТЬДАТ(ВТ_ЗаказыСОплатойВОдниДень.ДокументОплаты.Дата, РасчетыСКлиентами.Регистратор.Дата, ДЕНЬ) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыОплаты.ЗаказКлиента,
	ВТ_ДокументыОплаты.ДокументОплаты,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДЕНЬ(ВТ_ДокументыОплаты.ДокументОплаты.Дата)) КАК ДокументОплатыДата,
	ВТ_ДокументыОплаты.ДокументОплаты.ДокументОснование КАК ОснованиеДокументаОплаты
ПОМЕСТИТЬ ВТ_ПоСоглашениям
ИЗ
	ВТ_ДокументыОплаты КАК ВТ_ДокументыОплаты
ГДЕ
	ВТ_ДокументыОплаты.ЗаказКлиента ССЫЛКА Справочник.СоглашенияСКлиентами

СГРУППИРОВАТЬ ПО
	ВТ_ДокументыОплаты.ЗаказКлиента,
	ВТ_ДокументыОплаты.ДокументОплаты,
	ВТ_ДокументыОплаты.ДокументОплаты.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ПоСоглашениям.ЗаказКлиента,
	РасчетыСКлиентами.Регистратор,
	ВТ_ПоСоглашениям.ДокументОплаты
ПОМЕСТИТЬ ВТ_ПоСоглашениямДокументыОтгрузки
ИЗ
	ВТ_ПоСоглашениям КАК ВТ_ПоСоглашениям
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПО ВТ_ПоСоглашениям.ЗаказКлиента = РасчетыСКлиентами.ЗаказКлиента
			И (ВТ_ПоСоглашениям.ОснованиеДокументаОплаты = ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг).ЗаказКлиента)
ГДЕ
	РасчетыСКлиентами.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	И ВТ_ПоСоглашениям.ДокументОплатыДата = 1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ПоСоглашениям.ЗаказКлиента,
	ВТ_ПоСоглашениям.ОснованиеДокументаОплаты,
	ВТ_ПоСоглашениям.ДокументОплаты
ИЗ
	ВТ_ПоСоглашениям КАК ВТ_ПоСоглашениям
ГДЕ
	ВТ_ПоСоглашениям.ОснованиеДокументаОплаты ССЫЛКА Документ.РеализацияТоваровУслуг
	И ВТ_ПоСоглашениям.ДокументОплатыДата = 1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ПоСоглашениямДокументыОтгрузки.ЗаказКлиента,
	ВТ_ПоСоглашениямДокументыОтгрузки.Регистратор,
	СУММА(ВТ_ПоСоглашениямДокументыОтгрузки.ДокументОплаты.СуммаДокумента) КАК ДокументОплатыСуммаДокумента
ПОМЕСТИТЬ ВТ_ПроверкаСуммы
ИЗ
	ВТ_ПоСоглашениямДокументыОтгрузки КАК ВТ_ПоСоглашениямДокументыОтгрузки

СГРУППИРОВАТЬ ПО
	ВТ_ПоСоглашениямДокументыОтгрузки.ЗаказКлиента,
	ВТ_ПоСоглашениямДокументыОтгрузки.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ПроверкаСуммы.ЗаказКлиента,
	ВТ_ПроверкаСуммы.Регистратор КАК ДокументОтгрузки,
	ВТ_ПоСоглашениямДокументыОтгрузки.ДокументОплаты
ПОМЕСТИТЬ ВТ_ПоСоглашениямБезОстатков
ИЗ
	ВТ_ПроверкаСуммы КАК ВТ_ПроверкаСуммы
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ПоСоглашениямДокументыОтгрузки КАК ВТ_ПоСоглашениямДокументыОтгрузки
		ПО ВТ_ПроверкаСуммы.Регистратор = ВТ_ПоСоглашениямДокументыОтгрузки.Регистратор
ГДЕ
	ВТ_ПроверкаСуммы.Регистратор.СуммаДокумента = ВТ_ПроверкаСуммы.ДокументОплатыСуммаДокумента
	И РАЗНОСТЬДАТ(ВТ_ПоСоглашениямДокументыОтгрузки.ДокументОплаты.Дата, ВТ_ПроверкаСуммы.Регистратор.Дата, ДЕНЬ) <= 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_РеализацииБезЗаказаБезОстатка.ДокументОплаты КАК ДокументОплаты,
	ВТ_РеализацииБезЗаказаБезОстатка.ДокументОтгрузки КАК ДокументОтгрузки
ИЗ
	ВТ_РеализацииБезЗаказаБезОстатка КАК ВТ_РеализацииБезЗаказаБезОстатка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ЗаказыКлиентаБезОстатка.ДокументОплаты,
	ВТ_ЗаказыКлиентаБезОстатка.ДокументОтгрузки
ИЗ
	ВТ_ЗаказыКлиентаБезОстатка КАК ВТ_ЗаказыКлиентаБезОстатка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТ_ПоСоглашениямБезОстатков.ДокументОплаты,
	ВТ_ПоСоглашениямБезОстатков.ДокументОтгрузки
ИЗ
	ВТ_ПоСоглашениямБезОстатков КАК ВТ_ПоСоглашениямБезОстатков"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{9,
{3,
{0,"ИмяПараметра",
{"Pattern",
{"S"}
},"",0},
{1,"ЗначениеПараметра",
{"Pattern"},"",0},
{2,"ЭтоВыражение",
{"Pattern",
{"B"}
},"",0}
},
{2,3,0,0,1,1,2,2,
{1,1,
{2,0,3,
{"S","Дата"},
{"D",20171030000000},
{"B",0},0}
},2,0},
{0,0}
}
},
{"N",1},
{"N",44},0},
{2,3,5,
{"S","2"},
{"S","ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг) КАК ДокументРеализации,
	СУММА(РасчетыСКлиентами.Сумма) КАК Сумма,
	РасчетыСКлиентами.ЗаказКлиента
ПОМЕСТИТЬ ВТ_ДокументыРеализации
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.ДокументыВыгружаемыеВОтчетОРозничныхПродажах КАК ДокументыВыгружаемыеВОтчетОРозничныхПродажах
		ПО РасчетыСКлиентами.Регистратор = ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки
ГДЕ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)
	И ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки ЕСТЬ NULL 

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.РеализацияТоваровУслуг)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации
ПОМЕСТИТЬ ВТ_РеализацииБанковскийКредит
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
ГДЕ
	ВТ_ДокументыРеализации.ДокументРеализации.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.ФормыОплаты.БанковскийКредит)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыРеализации.ДокументРеализации
ИЗ
	ВТ_ДокументыРеализации КАК ВТ_ДокументыРеализации
		ПОЛНОЕ СОЕДИНЕНИЕ ВТ_РеализацииБанковскийКредит КАК ВТ_РеализацииБанковскийКредит
		ПО ВТ_ДокументыРеализации.ДокументРеализации = ВТ_РеализацииБанковскийКредит.ДокументРеализации
ГДЕ
	ВТ_РеализацииБанковскийКредит.ДокументРеализации Есть NULL"},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{9,
{3,
{0,"ИмяПараметра",
{"Pattern",
{"S"}
},"",0},
{1,"ЗначениеПараметра",
{"Pattern"},"",0},
{2,"ЭтоВыражение",
{"Pattern",
{"B"}
},"",0}
},
{2,3,0,0,1,1,2,2,
{1,1,
{2,0,3,
{"S","Дата"},
{"D",20171030000000},
{"B",0},0}
},2,0},
{0,0}
}
},
{"N",1},
{"N",61},0},
{2,4,5,
{"S","3 этап"},
{"S","ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) КАК ДокументОплаты,
	СУММА(РасчетыСКлиентами.Сумма) КАК Сумма,
	РасчетыСКлиентами.ЗаказКлиента
ПОМЕСТИТЬ ВТ_ДокументыОплаты
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
ГДЕ
	РасчетыСКлиентами.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеОплатыОтКлиентаВКассуККМ)
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ПриходныйКассовыйОрдер)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте),
	СУММА(РасчетыСКлиентами.Сумма),
	РасчетыСКлиентами.ЗаказКлиента
ИЗ
	РегистрНакопления.РасчетыСКлиентами КАК РасчетыСКлиентами
ГДЕ
	РасчетыСКлиентами.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеОплатыОтКлиента)
	И ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте) ЕСТЬ НЕ NULL 
	И РасчетыСКлиентами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ) И КОНЕЦПЕРИОДА(&Дата, ДЕНЬ)

СГРУППИРОВАТЬ ПО
	РасчетыСКлиентами.ЗаказКлиента,
	ВЫРАЗИТЬ(РасчетыСКлиентами.Регистратор КАК Документ.ОперацияПоПлатежнойКарте)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДокументыОплаты.ДокументОплаты,
	ВТ_ДокументыОплаты.Сумма,
	ВТ_ДокументыОплаты.ЗаказКлиента
<<<<<<< HEAD
ПОМЕСТИТЬ ВТ_2
=======
ПОМЕСТИТЬ ВТ_1
>>>>>>> parent of 197d986... разделение документов оплаты по документам отгрузки
ИЗ
	ВТ_ДокументыОплаты КАК ВТ_ДокументыОплаты
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.ДокументыВыгружаемыеВОтчетОРозничныхПродажах КАК ДокументыВыгружаемыеВОтчетОРозничныхПродажах
		ПО ВТ_ДокументыОплаты.ЗаказКлиента = ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки
		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.РеализацииВыгружаемыеВРеализацииБазИП КАК РеализацииВыгружаемыеВРеализацииБазИП
		ПО ВТ_ДокументыОплаты.ЗаказКлиента = РеализацииВыгружаемыеВРеализацииБазИП.ДокументОтгрузки
ГДЕ
	ДокументыВыгружаемыеВОтчетОРозничныхПродажах.ДокументОтгрузки ЕСТЬ NULL 
	И РеализацииВыгружаемыеВРеализацииБазИП.ДокументОтгрузки ЕСТЬ NULL "},
{"#",acf6192e-81ca-46ef-93a6-5a6968b78663,
{9,
{3,
{0,"ИмяПараметра",
{"Pattern",
{"S"}
},"",0},
{1,"ЗначениеПараметра",
{"Pattern"},"",0},
{2,"ЭтоВыражение",
{"Pattern",
{"B"}
},"",0}
},
{2,3,0,0,1,1,2,2,
{1,1,
{2,0,3,
{"S","Дата"},
{"D",20171030000000},
{"B",0},0}
},2,0},
{0,0}
}
},
{"N",1},
{"N",15},0}
}
}
},4,4}
}
}